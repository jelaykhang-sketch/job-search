<<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>JobFinder ‚Äî T√¨m vi·ªác cho sinh vi√™n</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .nav-active { background-color: #eef2ff; }
    /* simple modal backdrop */
    .modal-backdrop { background: rgba(0,0,0,0.45); }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- Header -->
  <header class="bg-white shadow sticky top-0 z-30">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <div>
        <div class="text-2xl font-bold text-indigo-600">JobFinder</div>
        <div class="text-xs text-gray-500 -mt-1">Prototype ‚Äî t√¨m vi·ªác minh b·∫°ch cho sinh vi√™n</div>
      </div>
      <nav class="flex gap-2 items-center text-sm">
        <button id="nav-home" class="px-3 py-2 rounded" onclick="showView('home')">Trang ch·ªß</button>
        <button id="nav-jobs" class="px-3 py-2 rounded" onclick="showView('jobs')">Vi·ªác l√†m</button>
        <button id="nav-cv" class="px-3 py-2 rounded" onclick="showView('cv')">T·∫°o CV</button>
        <button id="nav-quiz" class="px-3 py-2 rounded" onclick="showView('quiz')">Test ngh·ªÅ</button>
        <button id="nav-tracker" class="px-3 py-2 rounded" onclick="showView('tracker')">Theo d√µi</button>
      </nav>
    </div>
  </header>

  <!-- Hero Search -->
  <section class="max-w-6xl mx-auto px-4 mt-6">
    <div class="bg-white p-6 rounded-xl shadow flex flex-col md:flex-row gap-4 items-center">
      <div class="flex-1">
        <h1 class="text-2xl md:text-3xl font-bold">T√¨m vi·ªác ph√π h·ª£p ‚Äî nhanh & minh b·∫°ch</h1>
        <p class="text-sm text-gray-600 mt-1">T√¨m theo t√™n c√¥ng vi·ªác, c√¥ng ty ho·∫∑c ƒë·ªãa ƒëi·ªÉm.</p>
      </div>
      <div class="w-full md:w-2/3">
        <div class="flex gap-2">
          <input id="searchInput" type="text" placeholder="VD: Frontend, Logistics, Marketing..." class="flex-1 border rounded-lg px-4 py-3 shadow-sm" />
          <button onclick="showView('jobs'); renderJobs();" class="px-4 py-3 bg-indigo-600 text-white rounded-lg">T√¨m</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Views container -->
  <main class="max-w-6xl mx-auto px-4 mt-6 pb-12">

    <!-- HOME -->
    <section id="view-home" class="">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="md:col-span-2 space-y-4">
          <h2 class="text-xl font-semibold">Vi·ªác l√†m n·ªïi b·∫≠t</h2>
          <div id="featured-jobs" class="grid gap-4"></div>
        </div>

        <aside class="bg-white p-4 rounded-xl shadow">
          <h3 class="font-semibold mb-2">V√¨ sao d√πng JobFinder?</h3>
          <ul class="text-sm list-disc ml-5 text-gray-700 space-y-1">
            <li>Minh b·∫°ch m·ª©c l∆∞∆°ng & quy·ªÅn l·ª£i</li>
            <li>Giao di·ªán ƒë∆°n gi·∫£n, ph√π h·ª£p sinh vi√™n</li>
            <li>T·∫°o CV & theo d√µi tr·∫°ng th√°i n·ªôp h·ªì s∆°</li>
          </ul>
          <button class="mt-4 w-full px-3 py-2 bg-indigo-600 text-white rounded" onclick="showView('cv')">T·∫°o CV ngay</button>
        </aside>
      </div>

      <div class="mt-8 bg-white p-4 rounded-xl shadow">
        <h3 class="font-semibold mb-2">B·∫£ng tin</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 text-sm text-gray-700">
          <div class="p-3 border rounded">M·∫πo ph·ªèng v·∫•n: D√πng ph∆∞∆°ng ph√°p STAR ƒë·ªÉ tr·∫£ l·ªùi.</div>
          <div class="p-3 border rounded">Workshop CV: 15/12/2025 - ƒêƒÉng k√Ω s·ªõm.</div>
          <div class="p-3 border rounded">Tuy·ªÉn d·ª•ng: Nhi·ªÅu v·ªã tr√≠ remote th√°ng n√†y.</div>
        </div>
      </div>
    </section>

    <!-- JOBS -->
    <section id="view-jobs" class="hidden">
      <div class="mb-4">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
          <div class="flex gap-2 items-center flex-wrap">
            <span class="text-sm text-gray-600">L·ªçc theo ng√†nh:</span>
            <div id="categories" class="flex gap-2 flex-wrap"></div>
          </div>
          <div class="text-sm text-gray-600">K·∫øt qu·∫£: <span id="jobs-count">0</span></div>
        </div>
      </div>

      <div id="job-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
    </section>

    <!-- CV -->
    <section id="view-cv" class="hidden">
      <div class="bg-white p-6 rounded-xl shadow max-w-2xl">
        <h2 class="text-xl font-semibold mb-3">Tr√¨nh t·∫°o CV c∆° b·∫£n</h2>
        <div class="space-y-3">
          <input id="cv-name" class="w-full border p-2 rounded" placeholder="H·ªç v√† t√™n" />
          <input id="cv-email" class="w-full border p-2 rounded" placeholder="Email" />
          <input id="cv-phone" class="w-full border p-2 rounded" placeholder="S·ªë ƒëi·ªán tho·∫°i" />
          <input id="cv-edu" class="w-full border p-2 rounded" placeholder="H·ªçc v·∫•n" />
          <input id="cv-skill" class="w-full border p-2 rounded" placeholder="K·ªπ nƒÉng (ph√¢n c√°ch b·ªüi d·∫•u ph·∫©y)" />
          <textarea id="cv-summary" rows="3" class="w-full border p-2 rounded" placeholder="T√≥m t·∫Øt ng·∫Øn (1-2 c√¢u)"></textarea>

          <div class="flex gap-2">
            <button class="px-4 py-2 bg-indigo-600 text-white rounded" onclick="downloadCV()">T·∫£i CV (.txt)</button>
            <button class="px-4 py-2 border rounded" onclick="saveCVLocal()">L∆∞u CV (Local)</button>
            <button class="px-4 py-2 border rounded" onclick="clearCvForm()">X√≥a</button>
          </div>
        </div>

        <div class="mt-4 bg-gray-50 p-4 rounded text-sm">
          <div class="font-medium" id="cv-preview-name"></div>
          <div id="cv-preview-contact" class="text-gray-600 text-sm"></div>
          <div class="mt-2"><strong>H·ªçc v·∫•n:</strong> <span id="cv-preview-edu"></span></div>
          <div class="mt-1"><strong>K·ªπ nƒÉng:</strong> <span id="cv-preview-skill"></span></div>
          <div class="mt-1"><strong>T√≥m t·∫Øt:</strong> <span id="cv-preview-summary"></span></div>
        </div>
      </div>
    </section>

    <!-- QUIZ -->
    <section id="view-quiz" class="hidden">
      <div class="bg-white p-6 rounded-xl shadow max-w-2xl">
        <h2 class="text-xl font-semibold mb-3">Tr·∫Øc nghi·ªám ƒë·ªãnh h∆∞·ªõng ngh·ªÅ (ng·∫Øn)</h2>
        <div class="space-y-4">
          <div>
            <div class="font-medium mb-1">1) B·∫°n th√≠ch l√†m vi·ªác v·ªõi?</div>
            <select id="q1" class="w-full border p-2 rounded">
              <option value="">-- Ch·ªçn --</option>
              <option value="people">Con ng∆∞·ªùi</option>
              <option value="process">Quy tr√¨nh/Logistics</option>
              <option value="tech">C√¥ng ngh·ªá</option>
            </select>
          </div>

          <div>
            <div class="font-medium mb-1">2) Ho·∫°t ƒë·ªông y√™u th√≠ch?</div>
            <select id="q2" class="w-full border p-2 rounded">
              <option value="">-- Ch·ªçn --</option>
              <option value="hands-on">Th·ª±c t·∫ø</option>
              <option value="coding">L·∫≠p tr√¨nh</option>
              <option value="guiding">H∆∞·ªõng d·∫´n/Gi·∫£ng d·∫°y</option>
            </select>
          </div>

          <div>
            <div class="font-medium mb-1">3) M·ª•c ti√™u ngh·ªÅ nghi·ªáp?</div>
            <select id="q3" class="w-full border p-2 rounded">
              <option value="">-- Ch·ªçn --</option>
              <option value="stability">·ªîn ƒë·ªãnh</option>
              <option value="growth">Ph√°t tri·ªÉn nhanh</option>
              <option value="flexibility">Linh ho·∫°t</option>
            </select>
          </div>

          <div class="flex gap-2">
            <button class="px-4 py-2 bg-indigo-600 text-white rounded" onclick="runQuiz()">Xem g·ª£i √Ω</button>
            <button class="px-4 py-2 border rounded" onclick="resetQuiz()">L√†m l·∫°i</button>
          </div>

          <div id="quiz-result" class="mt-2 text-green-700 font-medium"></div>
        </div>
      </div>
    </section>

    <!-- TRACKER -->
    <section id="view-tracker" class="hidden">
      <div class="bg-white p-6 rounded-xl shadow">
        <h2 class="text-xl font-semibold mb-4">Theo d√µi tr·∫°ng th√°i h·ªì s∆°</h2>
        <div id="app-list" class="grid gap-3"></div>
      </div>
    </section>

  </main>

  <!-- Modals -->
  <div id="modal-root"></div>

  <!-- Footer -->
  <footer class="text-center text-sm text-gray-500 py-6">Prototype ‚Äî b·∫°n c√≥ th·ªÉ l∆∞u d·ªØ li·ªáu l√™n server sau n√†y. B·∫£n HTML thu·∫ßn.</footer>

<script>
/* ========================= DATA (many jobs) ========================= */
const JOBS = [
  { id: 'j1', title: 'Nh√¢n vi√™n Marketing', company: 'FPT Software', location: 'TP. H·ªì Ch√≠ Minh', salary: '8 - 12 tri·ªáu', type:'Full-time', category: 'Marketing', desc: 'L√™n k·∫ø ho·∫°ch n·ªôi dung, ch·∫°y qu·∫£ng c√°o, ph√¢n t√≠ch d·ªØ li·ªáu.' },
  { id: 'j2', title: 'Chuy√™n vi√™n Kinh doanh', company: 'Viettel', location: 'H√† N·ªôi', salary: '10 - 15 tri·ªáu + hoa h·ªìng', type:'Full-time', category: 'Kinh doanh', desc: 'T∆∞ v·∫•n kh√°ch h√†ng, ch·ªët h·ª£p ƒë·ªìng, chƒÉm s√≥c sau b√°n.' },
  { id: 'j3', title: 'L·∫≠p tr√¨nh vi√™n Frontend', company: 'Shopee', location: 'TP. H·ªì Ch√≠ Minh', salary: '20 - 35 tri·ªáu', type:'Hybrid', category: 'CNTT', desc: 'Ph√°t tri·ªÉn giao di·ªán web, t·ªëi ∆∞u hi·ªáu su·∫•t.' },
  { id: 'j4', title: 'Nh√¢n vi√™n B√°n h√†ng', company: 'Th·∫ø Gi·ªõi Di ƒê·ªông', location: 'ƒê·ªìng Nai', salary: '7 - 10 tri·ªáu', type:'Full-time', category: 'B√°n h√†ng', desc: 'T∆∞ v·∫•n s·∫£n ph·∫©m, h·ªó tr·ª£ kh√°ch h√†ng, qu·∫£n l√Ω kho.' },
  { id: 'j5', title: 'Data Analyst', company: 'Grab', location: 'TP. H·ªì Ch√≠ Minh', salary: '18 - 28 tri·ªáu', type:'Full-time', category: 'CNTT', desc: 'Tr·ª±c quan h√≥a d·ªØ li·ªáu, x√¢y dashboard, ph√¢n t√≠ch insight.' },
  { id: 'j6', title: 'Tr·ª£ gi·∫£ng Ti·∫øng Anh', company: 'VUS', location: 'H·ªì Ch√≠ Minh', salary: '6 - 12 tri·ªáu', type:'Part-time', category: 'Gi√°o d·ª•c', desc: 'H·ªó tr·ª£ gi√°o vi√™n ch√≠nh, ch·∫•m b√†i, theo d√µi h·ªçc sinh.' },
  { id: 'j7', title: 'DevOps Engineer (Junior)', company: 'LogiX', location: 'HCM (Hybrid)', salary: '18 - 25 tri·ªáu', type:'Full-time', category: 'CNTT', desc: 'Qu·∫£n tr·ªã h·∫° t·∫ßng, CI/CD, t·ªëi ∆∞u deploy.' },
  { id: 'j8', title: 'SEO Specialist', company: 'StartupX', location: 'Remote', salary: '8 - 15 tri·ªáu', type:'Remote', category: 'Marketing', desc: 'T·ªëi ∆∞u n·ªôi dung, l√™n chi·∫øn l∆∞·ª£c SEO.' },
  { id: 'j9', title: 'Nh√¢n vi√™n H·∫≠u c·∫ßn', company: 'TransMove', location: 'B√¨nh D∆∞∆°ng', salary: '6 - 9 tri·ªáu', type:'Full-time', category: 'Logistics', desc: 'Qu·∫£n l√Ω kho, ƒëi·ªÅu ph·ªëi v·∫≠n chuy·ªÉn.' },
  { id: 'j10', title: 'Tester (Manual)', company: 'FinTech Co.', location: 'H√† N·ªôi', salary: '10 - 14 tri·ªáu', type:'Full-time', category: 'CNTT', desc: 'Ki·ªÉm th·ª≠ ch·ª©c nƒÉng, vi·∫øt test case.' },
  { id: 'j11', title: 'Chuy√™n vi√™n HR', company: 'ABC Corp', location: 'HCM', salary: '9 - 13 tri·ªáu', type:'Full-time', category: 'Nh√¢n s·ª±', desc: 'Tuy·ªÉn d·ª•ng, ƒë√†o t·∫°o, x√¢y ch√≠nh s√°ch nh√¢n s·ª±.' },
  { id: 'j12', title: 'Graphic Designer', company: 'DesignHub', location: 'HCM', salary: '10 - 18 tri·ªáu', type:'Hybrid', category: 'Thi·∫øt k·∫ø', desc: 'Thi·∫øt k·∫ø visual cho chi·∫øn d·ªãch, social.' }
];

const CATEGORIES = ['T·∫•t c·∫£','CNTT','Marketing','Kinh doanh','B√°n h√†ng','Gi√°o d·ª•c','Logistics','Nh√¢n s·ª±','Thi·∫øt k·∫ø'];

/* ========================= STATE ========================= */
let state = {
  view: 'home',
  query: '',
  category: 'T·∫•t c·∫£',
  applications: JSON.parse(localStorage.getItem('jf_applications') || '[]'),
  savedCv: JSON.parse(localStorage.getItem('jf_cv') || 'null')
};

/* ========================= UTIL & VIEW CONTROL ========================= */

function showView(view) {
  state.view = view;
  document.querySelectorAll('[id^="view-"]').forEach(el => el.classList.add('hidden'));
  document.getElementById('view-' + view).classList.remove('hidden');

  document.querySelectorAll('nav button').forEach(b => b.classList.remove('nav-active'));
  const navBtn = document.getElementById('nav-' + view);
  if (navBtn) navBtn.classList.add('nav-active');

  if (view === 'home') renderFeatured();
  if (view === 'jobs') renderJobs();
  if (view === 'tracker') renderApplications();
  if (view === 'cv') loadCvToForm();
}

function init() {
  renderCategories();
  renderFeatured();
  attachGlobalHandlers();
  showView('home');
}

/* ========================= RENDER CATEGORIES ========================= */

function renderCategories() {
  const box = document.getElementById('categories');
  box.innerHTML = '';
  CATEGORIES.forEach(cat => {
    const btn = document.createElement('button');
    btn.className = `px-3 py-1 rounded-full text-sm border ${state.category===cat ? 'bg-indigo-600 text-white' : 'bg-white'}`;
    btn.textContent = cat;
    btn.onclick = () => { state.category = cat; renderCategories(); renderJobs(); };
    box.appendChild(btn);
  });
}

/* ========================= RENDER JOBS ========================= */

function getFilteredJobs() {
  const q = (document.getElementById('searchInput').value || '').toLowerCase().trim();
  return JOBS.filter(job => {
    const matchQuery = job.title.toLowerCase().includes(q) || job.company.toLowerCase().includes(q) || job.location.toLowerCase().includes(q);
    const matchCat = state.category === 'T·∫•t c·∫£' || job.category === state.category;
    return matchQuery && matchCat;
  });
}

function renderJobs() {
  const list = document.getElementById('job-list');
  const filtered = getFilteredJobs();
  document.getElementById('jobs-count').innerText = filtered.length;
  list.innerHTML = '';
  if (filtered.length === 0) {
    list.innerHTML = '<div class="p-6 bg-white rounded-xl text-center text-gray-500">Kh√¥ng t√¨m th·∫•y c√¥ng vi·ªác ph√π h·ª£p.</div>';
    return;
  }
  filtered.forEach(job => {
    const card = document.createElement('div');
    card.className = 'p-4 bg-white rounded-2xl shadow border hover:shadow-lg transition';
    card.innerHTML = `
      <div class="flex justify-between items-start">
        <div>
          <h3 class="text-lg font-semibold">${job.title}</h3>
          <div class="text-sm text-gray-600">${job.company} ‚Ä¢ ${job.location}</div>
        </div>
        <div class="text-right">
          <div class="text-indigo-600 font-medium">üí∞ ${job.salary}</div>
          <div class="text-xs text-gray-500 mt-1">${job.type}</div>
        </div>
      </div>
      <p class="mt-3 text-sm text-gray-700">${job.desc}</p>
      <div class="mt-4 flex gap-2">
        <button class="px-3 py-2 bg-blue-600 text-white rounded" onclick="openDetail('${job.id}')">Xem chi ti·∫øt</button>
        <button class="px-3 py-2 border rounded" onclick="openApplyModal('${job.id}')">·ª®ng tuy·ªÉn</button>
      </div>
    `;
    list.appendChild(card);
  });
}

/* ========================= FEATURED (home) ========================= */

function renderFeatured() {
  const box = document.getElementById('featured-jobs');
  box.innerHTML = '';
  JOBS.slice(0,4).forEach(job => {
    const el = document.createElement('div');
    el.className = 'p-4 bg-white rounded-xl border shadow';
    el.innerHTML = `
      <div class="flex justify-between">
        <div>
          <div class="font-semibold">${job.title}</div>
          <div class="text-sm text-gray-600">${job.company} ‚Ä¢ ${job.location}</div>
        </div>
        <div class="text-right">
          <div class="text-indigo-600 font-medium">${job.salary}</div>
          <div class="text-xs text-gray-500">${job.type}</div>
        </div>
      </div>
      <p class="mt-2 text-sm text-gray-700">${job.desc}</p>
      <div class="mt-3 flex gap-2">
        <button class="px-3 py-2 bg-indigo-600 text-white rounded" onclick="openDetail('${job.id}')">Xem</button>
        <button class="px-3 py-2 border rounded" onclick="openApplyModal('${job.id}')">N·ªôp CV</button>
      </div>
    `;
    box.appendChild(el);
  });
}

/* ========================= MODALS (detail & apply) ========================= */

function openDetail(jobId) {
  const job = JOBS.find(j => j.id === jobId);
  if (!job) return;
  const modal = createModal(`
    <div class="bg-white rounded-xl max-w-2xl p-6">
      <div class="flex justify-between items-start">
        <div>
          <h3 class="text-2xl font-semibold">${job.title}</h3>
          <div class="text-sm text-gray-600">${job.company} ‚Ä¢ ${job.location}</div>
        </div>
        <div class="text-indigo-600 font-medium">${job.salary}</div>
      </div>
      <div class="mt-4 text-gray-700">
        <p><strong>M√¥ t·∫£:</strong> ${job.desc}</p>
        <p class="mt-2"><strong>Lo·∫°i:</strong> ${job.type} ‚Ä¢ <strong>Ng√†nh:</strong> ${job.category}</p>
      </div>
      <div class="mt-4 flex gap-2">
        <button class="px-3 py-2 bg-blue-600 text-white rounded" onclick="openApplyModal('${job.id}'); closeModal()">·ª®ng tuy·ªÉn</button>
        <button class="px-3 py-2 border rounded" onclick="closeModal()">ƒê√≥ng</button>
      </div>
    </div>
  `);
  showModal(modal);
}

function openApplyModal(jobId) {
  const job = JOBS.find(j => j.id === jobId);
  if (!job) return;
  const existingCv = JSON.parse(localStorage.getItem('jf_cv') || 'null') || {};
  const modal = createModal(`
    <div class="bg-white rounded-xl max-w-xl p-6">
      <h3 class="text-xl font-semibold">·ª®ng tuy·ªÉn: ${job.title}</h3>
      <div class="mt-3 space-y-2">
        <input id="apply-name" class="w-full border p-2 rounded" placeholder="H·ªç v√† t√™n" value="${escapeHtml(existingCv.name||'')}" />
        <input id="apply-email" class="w-full border p-2 rounded" placeholder="Email" value="${escapeHtml(existingCv.email||'')}" />
        <input id="apply-phone" class="w-full border p-2 rounded" placeholder="S·ªë ƒëi·ªán tho·∫°i" value="${escapeHtml(existingCv.phone||'')}" />
        <textarea id="apply-note" class="w-full border p-2 rounded" rows="3" placeholder="Ghi ch√∫ (t√πy ch·ªçn)"></textarea>
      </div>
      <div class="mt-4 flex gap-2">
        <button class="px-3 py-2 bg-green-600 text-white rounded" onclick="submitApplication('${job.id}'); closeModal()">N·ªôp CV</button>
        <button class="px-3 py-2 border rounded" onclick="closeModal()">H·ªßy</button>
      </div>
    </div>
  `);
  showModal(modal);
}

/* modal helpers */
function createModal(htmlContent){
  const root = document.getElementById('modal-root');
  const container = document.createElement('div');
  container.className = 'fixed inset-0 flex items-center justify-center modal-backdrop';
  container.innerHTML = `<div class="max-h-[90vh] overflow-auto p-4">${htmlContent}</div>`;
  container.onclick = (e) => { if (e.target === container) closeModal(); };
  return container;
}
function showModal(element) {
  const root = document.getElementById('modal-root');
  root.innerHTML = '';
  root.appendChild(element);
  document.body.style.overflow = 'hidden';
}
function closeModal() {
  const root = document.getElementById('modal-root');
  root.innerHTML = '';
  document.body.style.overflow = '';
}

function escapeHtml(s){
  if(!s) return '';
  return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;');
}

/* ========================= APPLICATIONS: submit & render ========================= */

function submitApplication(jobId) {
  const name = (document.getElementById('apply-name') || {}).value || '';
  const email = (document.getElementById('apply-email') || {}).value || '';
  const phone = (document.getElementById('apply-phone') || {}).value || '';
  const note = (document.getElementById('apply-note') || {}).value || '';

  if (!name || !email) {
    alert('Vui l√≤ng ƒëi·ªÅn √≠t nh·∫•t t√™n v√† email ƒë·ªÉ n·ªôp CV.');
    return;
  }

  const job = JOBS.find(j=>j.id===jobId);
  const app = {
    id: Date.now(),
    jobId,
    jobTitle: job.title,
    company: job.company,
    appliedAt: new Date().toLocaleDateString(),
    status: 'Submitted',
    applicant: { name, email, phone, note }
  };

  state.applications.unshift(app);
  localStorage.setItem('jf_applications', JSON.stringify(state.applications));
  alert('N·ªôp CV th√†nh c√¥ng!');
  showView('tracker');
  renderApplications();
}

function renderApplications() {
  const box = document.getElementById('app-list');
  box.innerHTML = '';
  if (!state.applications || state.applications.length === 0) {
    box.innerHTML = '<div class="p-4 bg-white border rounded">B·∫°n ch∆∞a n·ªôp CV n√†o.</div>';
    return;
  }
  state.applications.forEach(a => {
    const el = document.createElement('div');
    el.className = 'p-4 bg-white border rounded';
    el.innerHTML = `
      <div class="flex justify-between items-start">
        <div>
          <div class="font-medium">${a.jobTitle} ‚Ä¢ ${a.company}</div>
          <div class="text-sm text-gray-600">N·ªôp: ${a.appliedAt}</div>
          <div class="text-sm mt-2">·ª®ng vi√™n: ${a.applicant.name} ‚Ä¢ ${a.applicant.email} ${a.applicant.phone? '‚Ä¢ '+a.applicant.phone : ''}</div>
          ${a.applicant.note? `<div class="text-xs text-gray-600 mt-1">Ghi ch√∫: ${escapeHtml(a.applicant.note)}</div>` : ''}
        </div>
        <div class="flex flex-col gap-2 items-end">
          <select onchange="changeAppStatus(${a.id}, this.value)" class="border rounded p-1 text-sm">
            <option ${a.status==='Submitted'?'selected':''}>Submitted</option>
            <option ${a.status==='Pending'?'selected':''}>Pending</option>
            <option ${a.status==='Interview'?'selected':''}>Interview</option>
            <option ${a.status==='Rejected'?'selected':''}>Rejected</option>
            <option ${a.status==='Hired'?'selected':''}>Hired</option>
          </select>
          <button class="text-xs px-2 py-1 border rounded" onclick="copyApp(${a.id})">Sao ch√©p</button>
        </div>
      </div>
    `;
    box.appendChild(el);
  });
}

function changeAppStatus(id, status) {
  state.applications = state.applications.map(a => a.id === id ? {...a, status} : a);
  localStorage.setItem('jf_applications', JSON.stringify(state.applications));
  renderApplications();
}

function copyApp(id) {
  const app = state.applications.find(a => a.id === id);
  if (!app) return;
  navigator.clipboard.writeText(JSON.stringify(app, null, 2));
  alert('ƒê√£ sao ch√©p chi ti·∫øt ·ª©ng tuy·ªÉn.');
}

/* ========================= CV Download & Save ========================= */

function downloadCV() {
  const name = document.getElementById('cv-name').value || '';
  const email = document.getElementById('cv-email').value || '';
  const phone = document.getElementById('cv-phone').value || '';
  const edu = document.getElementById('cv-edu').value || '';
  const skill = document.getElementById('cv-skill').value || '';
  const sum = document.getElementById('cv-summary').value || '';

  const content = `T√™n: ${name}\nEmail: ${email}\nSƒêT: ${phone}\n\nH·ªçc v·∫•n:\n${edu}\n\nK·ªπ nƒÉng:\n${skill}\n\nT√≥m t·∫Øt:\n${sum}\n`;
  const blob = new Blob([content], {type:'text/plain;charset=utf-8'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = (name || 'cv') + '.txt';
  a.click();
  URL.revokeObjectURL(a.href);
}

function saveCVLocal() {
  const cv = {
    name: document.getElementById('cv-name').value || '',
    email: document.getElementById('cv-email').value || '',
    phone: document.getElementById('cv-phone').value || '',
    edu: document.getElementById('cv-edu').value || '',
    skill: document.getElementById('cv-skill').value || '',
    summary: document.getElementById('cv-summary').value || ''
  };
  localStorage.setItem('jf_cv', JSON.stringify(cv));
  state.savedCv = cv;
  alert('ƒê√£ l∆∞u CV v√†o tr√¨nh duy·ªát (local).');
  loadCvToForm();
}

function loadCvToForm() {
  const cv = JSON.parse(localStorage.getItem('jf_cv') || 'null') || {};
  document.getElementById('cv-name').value = cv.name || '';
  document.getElementById('cv-email').value = cv.email || '';
  document.getElementById('cv-phone').value = cv.phone || '';
  document.getElementById('cv-edu').value = cv.edu || '';
  document.getElementById('cv-skill').value = cv.skill || '';
  document.getElementById('cv-summary').value = cv.summary || '';
  updateCvPreview();
}

function clearCvForm() {
  ['cv-name','cv-email','cv-phone','cv-edu','cv-skill','cv-summary'].forEach(id => document.getElementById(id).value = '');
  updateCvPreview();
}

function updateCvPreview() {
  document.getElementById('cv-preview-name').innerText = document.getElementById('cv-name').value || '';
  document.getElementById('cv-preview-contact').innerText = (document.getElementById('cv-email').value || '') + (document.getElementById('cv-phone').value ? ' ‚Ä¢ '+document.getElementById('cv-phone').value : '');
  document.getElementById('cv-preview-edu').innerText = document.getElementById('cv-edu').value || '';
  document.getElementById('cv-preview-skill').innerText = document.getElementById('cv-skill').value || '';
  document.getElementById('cv-preview-summary').innerText = document.getElementById('cv-summary').value || '';
}

/* attach form preview updates */
function attachGlobalHandlers(){
  document.getElementById('searchInput').addEventListener('input', () => { renderJobs(); });
  ['cv-name','cv-email','cv-phone','cv-edu','cv-skill','cv-summary'].forEach(id=>{
    document.getElementById(id).addEventListener('input', updateCvPreview);
  });
}

/* ========================= QUIZ ========================= */

function runQuiz(){
  const q1 = document.getElementById('q1').value;
  const q2 = document.getElementById('q2').value;
  const q3 = document.getElementById('q3').value;
  if(!q1 || !q2 || !q3){ alert('Vui l√≤ng tr·∫£ l·ªùi ƒë·ªß 3 c√¢u.'); return; }

  let score = { logistics:0, tech:0, teaching:0, marketing:0 };
  if(q1==='people') { teaching+=0; score.teaching += 2; score.marketing += 1; }
  if(q1==='process') score.logistics += 2;
  if(q1==='tech') score.tech += 2;

  if(q2==='hands-on') score.logistics += 1;
  if(q2==='coding') score.tech += 2;
  if(q2==='guiding') score.teaching += 1;

  if(q3==='stability') score.logistics += 1;
  if(q3==='growth') score.tech += 2;
  if(q3==='flexibility') score.teaching += 1;

  const top = Object.entries(score).sort((a,b)=>b[1]-a[1])[0][0];
  const msgs = {
    logistics: 'G·ª£i √Ω: Logistics / Supply Chain / Operations.',
    tech: 'G·ª£i √Ω: C√¥ng ngh·ªá ‚Äî th·ª≠ Frontend / QA / IT Support.',
    teaching: 'G·ª£i √Ω: D·∫°y k√®m / Tr·ª£ gi·∫£ng / ƒê√†o t·∫°o.',
    marketing: 'G·ª£i √Ω: Marketing / N·ªôi dung / SEO.'
  };
  document.getElementById('quiz-result').innerText = msgs[top] || 'G·ª£i √Ω: Th·ª≠ nhi·ªÅu v·ªã tr√≠ ƒë·ªÉ bi·∫øt s·ªü th√≠ch.';
}

function resetQuiz(){
  document.getElementById('q1').value='';
  document.getElementById('q2').value='';
  document.getElementById('q3').value='';
  document.getElementById('quiz-result').innerText='';
}

/* ========================= INITIALIZE ========================= */
(function(){
  // load saved applications & cv
  state.applications = JSON.parse(localStorage.getItem('jf_applications') || '[]');
  init();
})();
</script>

</body>
</html>
